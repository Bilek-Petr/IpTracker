(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const c of n.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function r(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerPolicy&&(n.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?n.credentials="include":o.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function a(o){if(o.ep)return;o.ep=!0;const n=r(o);fetch(o.href,n)}})();const u="at_c2HQWFpmt2eYh6lPsqStmkmkmrP9T";console.log(u);const y=async t=>{try{const e=await fetch(t);if(!e.ok)throw new Error(`HTTP error! status ${e.status}`);return await e.json()}catch(e){throw console.error("Error fetching IP location: "+e),e}},h=async t=>{const e=`https://geo.ipify.org/api/v2/country,city?apiKey=${u}&ipAddress=${t}`;return await y(e)},i=async()=>{const t=`https://geo.ipify.org/api/v2/country,city?apiKey=${u}&ipAddress=`;return await y(t)},g=t=>{var o,n,c;const e={ip:document.querySelector("[data-ip]"),location:document.querySelector("[data-location]"),timezone:document.querySelector("[data-timezone]"),isp:document.querySelector("[data-isp]")},r=(p,P)=>{p&&(p.textContent=P||"N/A")};r(e.ip,t.ip??"N/A");const a=`${((o=t.location)==null?void 0:o.region)??"N/A"}, ${((n=t.location)==null?void 0:n.country)??"N/A"}`;r(e.location,a),r(e.timezone,((c=t.location)==null?void 0:c.timezone)??"N/A"),r(e.isp,t.isp??"N/A")},w=t=>{const{lat:e,lng:r}=t.location;return{latitude:e,longitude:r}},A=()=>L.icon({iconUrl:"public/assets/images/icon-location.svg",iconSize:[46,56],iconAnchor:[23,56],popupAnchor:[0,-56]}),k=(t,e,r)=>{const a=L.map("map").setView([t,e],13);L.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:18,minZoom:3,attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}).addTo(a);const o=L.marker([t,e],{icon:r}).addTo(a);return{map:a,marker:o}},I=async(t,e,r)=>{try{const a=await r(),{latitude:o,longitude:n}=w(a);e&&t.removeLayer(e);const c=L.marker([o,n],{icon:A()}).addTo(t);return t.setView([o,n]),c}catch(a){return console.error("Error updating map with IP location: ",a.message),e}},v=async()=>{try{const t=await i(),{latitude:e,longitude:r}=w(t),a=A(),{map:o,marker:n}=k(e,r,a),c=await I(o,n,i);return{map:o,marker:c}}catch(t){return console.error("Error fetching initial location: ",t),null}},S=async(t,e,r)=>await I(t,e,()=>h(r)),s=document.querySelector("#form__input");let M,l;const N=()=>s.value.trim(),d=t=>{t.classList.add("shake"),setTimeout(()=>t.classList.remove("shake"),300)},E=async t=>{t.preventDefault();const e=N();if(!e){console.error("Please enter a valid IP address"),d(s);return}try{const r=await h(e);g(r),l=await S(M,l,e)}catch(r){console.error("Error fetching data: "+r),d(s)}},T=(t,e)=>{M=t,l=e};let m,f;document.addEventListener("DOMContentLoaded",async()=>{const t=await v();if(t){m=t.map,f=t.marker,T(m,f),document.querySelector("form").addEventListener("submit",E);try{const r=await i();g(r)}catch(r){console.error("Error fetching data: "+r)}}else console.error("Failed to initialize and load map")});
